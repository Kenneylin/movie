<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="../CSS/choosestyle.css" rel="stylesheet" type="text/css" />
    <title>Seat</title>
</head>

<body>
    <div style="width:900px;margin: 0 auto;">
        <span id='screen'>
            <p>
                荧幕
            </p>
        </span>
        <div id="seats">
            <div class="seatsRaw" onclick="change()">
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
                <div class="seat"></div>
            </div>
        </div>
        <div id="booking_desc">
            <div class="booking_left">
                <p style="color: #FBBC53;font-weight: bold; font-size: larger;">您选中的座位 </p>
                <div id="selected_seat"></div>
                <br>
                <button id="confirm" type="button" onclick="confirm()">confirm it!</button>
                <button id="choose" onclick="nums()">click it!</button>
                <div id="errMsg"></div>
            </div>

            <div class="booking_right">每个座位的单价: 10.00 元
                <br><br>
                <div id="total">总价：<span> 0 </span></div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        window.onload = myfuction();//当html加载完后，给每个div设置颜色的状态为0（未选蓝色，1红色已选）
        function myfuction() {
            var a = document.getElementsByClassName("seat");
            for (var i = 1; i < a.length; i++) {
                var b = a[i];
                if (b.dataset.falut != "2") {
                    b.dataset.falut = "0";
                }
            }
        }
        var times = 0;
        function change() {
            var x = event.target;                    //x为鼠标点击的元素
            var a = x.dataset.falut; //下一步就是通过元素的属性，就知道  
            if (x.dataset.falut != "2") {//座位未选
                if (x.className == 'seat') {//点击的是座位
                    if (a == "0") {                  //0表示为蓝色未选中
                        x.style.backgroundColor = "red";
                        x.dataset.falut = "1";
                    }
                    else {
                        x.style.backgroundColor = "#D8D8D8";
                        x.dataset.falut = "0";
                    }
                    times++;
                }
            }
        }

        function nums() {
            var nums = 0;
            //    var id="";
            var a = document.getElementsByClassName("seat");
            for (var i = 1; i < a.length; i++) {
                if (a[i].dataset.falut == "1") {
                    //    id+=a[i].id;
                    nums++;
                }
            }
            document.getElementById("total").innerHTML = parseInt(nums) * 10;//"   "+id
        }

        function confirm() {
            var a = document.getElementsByClassName("seat");
            for (var i = 1; i < a.length; i++) {
                if (a[i].dataset.falut == "1") {
                    a[i].dataset.falut = "2";
                }
            }
        }

        
        function etQueryString(name) {
            var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if(r!=null)return  unescape(r[2]); return null;
        }

        // 初始化检查 本地数据库是否存在数据，同时进行渲染
        function init() {

        }

        // 存储到本地座位
        function setLocalSeat(x, y) {

        }

        function removeLocalSeatt(x, y) {

        }
    </script>
</body>

</html>